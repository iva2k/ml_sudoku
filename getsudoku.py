#!/usr/bin/env python3

'''
<TABLE id="puzzle_grid" CELLSPACING=0 CELLPADDING=0 CLASS=t>
<TR>
  <TD CLASS=g0 ID=c00><INPUT CLASS=d0 SIZE=2 AUTOCOMPLETE=off NAME=h54r511 MAXLENGTH=5 onKeyUp="j5(this)" onBlur="j8(this)" ID=f00></TD>
  <TD CLASS=f0 ID=c10><INPUT CLASS=d0 SIZE=2 AUTOCOMPLETE=off NAME=h54r521 MAXLENGTH=5 onKeyUp="j5(this)" onBlur="j8(this)" ID=f10></TD>
  <TD CLASS=f0 ID=c20><INPUT CLASS=s0 SIZE=2 AUTOCOMPLETE=off NAME=sh54r531 READONLY VALUE="7" ID=f20></TD>
  <TD CLASS=g0 ID=c30><INPUT CLASS=d0 SIZE=2 AUTOCOMPLETE=off NAME=h54r541 MAXLENGTH=5 onKeyUp="j5(this)" onBlur="j8(this)" ID=f30></TD>
  <TD CLASS=f0 ID=c40><INPUT CLASS=s0 SIZE=2 AUTOCOMPLETE=off NAME=sh54r551 READONLY VALUE="5" ID=f40></TD>
  <TD CLASS=f0 ID=c50><INPUT CLASS=d0 SIZE=2 AUTOCOMPLETE=off NAME=h54r561 MAXLENGTH=5 onKeyUp="j5(this)" onBlur="j8(this)" ID=f50></TD>
  <TD CLASS=g0 ID=c60><INPUT CLASS=s0 SIZE=2 AUTOCOMPLETE=off NAME=sh54r571 READONLY VALUE="3" ID=f60></TD>
  <TD CLASS=f0 ID=c70><INPUT CLASS=d0 SIZE=2 AUTOCOMPLETE=off NAME=h54r581 MAXLENGTH=5 onKeyUp="j5(this)" onBlur="j8(this)" ID=f70></TD>
  <TD CLASS=f0 ID=c80><INPUT CLASS=d0 SIZE=2 AUTOCOMPLETE=off NAME=h54r591 MAXLENGTH=5 onKeyUp="j5(this)" onBlur="j8(this)" ID=f80></TD>
</TR>
<TR><TD CLASS=e0 ID=c01><INPUT CLASS=s0 SIZE=2 AUTOCOMPLETE=off NAME=sh54r512 READONLY VALUE="4" ID=f01></TD><TD CLASS=c0 ID=c11><INPUT CLASS=d0 SIZE=2 AUTOCOMPLETE=off NAME=h54r522 MAXLENGTH=5 onKeyUp="j5(this)" onBlur="j8(this)" ID=f11></TD><TD CLASS=c0 ID=c21><INPUT CLASS=d0 SIZE=2 AUTOCOMPLETE=off NAME=h54r532 MAXLENGTH=5 onKeyUp="j5(this)" onBlur="j8(this)" ID=f21></TD><TD CLASS=e0 ID=c31><INPUT CLASS=d0 SIZE=2 AUTOCOMPLETE=off NAME=h54r542 MAXLENGTH=5 onKeyUp="j5(this)" onBlur="j8(this)" ID=f31></TD><TD CLASS=c0 ID=c41><INPUT CLASS=d0 SIZE=2 AUTOCOMPLETE=off NAME=h54r552 MAXLENGTH=5 onKeyUp="j5(this)" onBlur="j8(this)" ID=f41></TD><TD CLASS=c0 ID=c51><INPUT CLASS=s0 SIZE=2 AUTOCOMPLETE=off NAME=sh54r562 READONLY VALUE="7" ID=f51></TD><TD CLASS=e0 ID=c61><INPUT CLASS=s0 SIZE=2 AUTOCOMPLETE=off NAME=sh54r572 READONLY VALUE="9" ID=f61></TD><TD CLASS=c0 ID=c71><INPUT CLASS=d0 SIZE=2 AUTOCOMPLETE=off NAME=h54r582 MAXLENGTH=5 onKeyUp="j5(this)" onBlur="j8(this)" ID=f71></TD><TD CLASS=c0 ID=c81><INPUT CLASS=d0 SIZE=2 AUTOCOMPLETE=off NAME=h54r592 MAXLENGTH=5 onKeyUp="j5(this)" onBlur="j8(this)" ID=f81></TD></TR><TR><TD CLASS=e0 ID=c02><INPUT CLASS=d0 SIZE=2 AUTOCOMPLETE=off NAME=h54r513 MAXLENGTH=5 onKeyUp="j5(this)" onBlur="j8(this)" ID=f02></TD><TD CLASS=c0 ID=c12><INPUT CLASS=s0 SIZE=2 AUTOCOMPLETE=off NAME=sh54r523 READONLY VALUE="6" ID=f12></TD><TD CLASS=c0 ID=c22><INPUT CLASS=d0 SIZE=2 AUTOCOMPLETE=off NAME=h54r533 MAXLENGTH=5 onKeyUp="j5(this)" onBlur="j8(this)" ID=f22></TD><TD CLASS=e0 ID=c32><INPUT CLASS=d0 SIZE=2 AUTOCOMPLETE=off NAME=h54r543 MAXLENGTH=5 onKeyUp="j5(this)" onBlur="j8(this)" ID=f32></TD><TD CLASS=c0 ID=c42><INPUT CLASS=d0 SIZE=2 AUTOCOMPLETE=off NAME=h54r553 MAXLENGTH=5 onKeyUp="j5(this)" onBlur="j8(this)" ID=f42></TD><TD CLASS=c0 ID=c52><INPUT CLASS=s0 SIZE=2 AUTOCOMPLETE=off NAME=sh54r563 READONLY VALUE="1" ID=f52></TD><TD CLASS=e0 ID=c62><INPUT CLASS=s0 SIZE=2 AUTOCOMPLETE=off NAME=sh54r573 READONLY VALUE="8" ID=f62></TD><TD CLASS=c0 ID=c72><INPUT CLASS=d0 SIZE=2 AUTOCOMPLETE=off NAME=h54r583 MAXLENGTH=5 onKeyUp="j5(this)" onBlur="j8(this)" ID=f72></TD><TD CLASS=c0 ID=c82><INPUT CLASS=d0 SIZE=2 AUTOCOMPLETE=off NAME=h54r593 MAXLENGTH=5 onKeyUp="j5(this)" onBlur="j8(this)" ID=f82></TD></TR><TR><TD CLASS=g0 ID=c03><INPUT CLASS=d0 SIZE=2 AUTOCOMPLETE=off NAME=h54r514 MAXLENGTH=5 onKeyUp="j5(this)" onBlur="j8(this)" ID=f03></TD><TD CLASS=f0 ID=c13><INPUT CLASS=s0 SIZE=2 AUTOCOMPLETE=off NAME=sh54r524 READONLY VALUE="3" ID=f13></TD><TD CLASS=f0 ID=c23><INPUT CLASS=d0 SIZE=2 AUTOCOMPLETE=off NAME=h54r534 MAXLENGTH=5 onKeyUp="j5(this)" onBlur="j8(this)" ID=f23></TD><TD CLASS=g0 ID=c33><INPUT CLASS=d0 SIZE=2 AUTOCOMPLETE=off NAME=h54r544 MAXLENGTH=5 onKeyUp="j5(this)" onBlur="j8(this)" ID=f33></TD><TD CLASS=f0 ID=c43><INPUT CLASS=d0 SIZE=2 AUTOCOMPLETE=off NAME=h54r554 MAXLENGTH=5 onKeyUp="j5(this)" onBlur="j8(this)" ID=f43></TD><TD CLASS=f0 ID=c53><INPUT CLASS=s0 SIZE=2 AUTOCOMPLETE=off NAME=sh54r564 READONLY VALUE="4" ID=f53></TD><TD CLASS=g0 ID=c63><INPUT CLASS=d0 SIZE=2 AUTOCOMPLETE=off NAME=h54r574 MAXLENGTH=5 onKeyUp="j5(this)" onBlur="j8(this)" ID=f63></TD><TD CLASS=f0 ID=c73><INPUT CLASS=d0 SIZE=2 AUTOCOMPLETE=off NAME=h54r584 MAXLENGTH=5 onKeyUp="j5(this)" onBlur="j8(this)" ID=f73></TD><TD CLASS=f0 ID=c83><INPUT CLASS=s0 SIZE=2 AUTOCOMPLETE=off NAME=sh54r594 READONLY VALUE="9" ID=f83></TD></TR><TR><TD CLASS=e0 ID=c04><INPUT CLASS=d0 SIZE=2 AUTOCOMPLETE=off NAME=h54r515 MAXLENGTH=5 onKeyUp="j5(this)" onBlur="j8(this)" ID=f04></TD><TD CLASS=c0 ID=c14><INPUT CLASS=d0 SIZE=2 AUTOCOMPLETE=off NAME=h54r525 MAXLENGTH=5 onKeyUp="j5(this)" onBlur="j8(this)" ID=f14></TD><TD CLASS=c0 ID=c24><INPUT CLASS=s0 SIZE=2 AUTOCOMPLETE=off NAME=sh54r535 READONLY VALUE="4" ID=f24></TD><TD CLASS=e0 ID=c34><INPUT CLASS=d0 SIZE=2 AUTOCOMPLETE=off NAME=h54r545 MAXLENGTH=5 onKeyUp="j5(this)" onBlur="j8(this)" ID=f34></TD><TD CLASS=c0 ID=c44><INPUT CLASS=d0 SIZE=2 AUTOCOMPLETE=off NAME=h54r555 MAXLENGTH=5 onKeyUp="j5(this)" onBlur="j8(this)" ID=f44></TD><TD CLASS=c0 ID=c54><INPUT CLASS=d0 SIZE=2 AUTOCOMPLETE=off NAME=h54r565 MAXLENGTH=5 onKeyUp="j5(this)" onBlur="j8(this)" ID=f54></TD><TD CLASS=e0 ID=c64><INPUT CLASS=s0 SIZE=2 AUTOCOMPLETE=off NAME=sh54r575 READONLY VALUE="6" ID=f64></TD><TD CLASS=c0 ID=c74><INPUT CLASS=d0 SIZE=2 AUTOCOMPLETE=off NAME=h54r585 MAXLENGTH=5 onKeyUp="j5(this)" onBlur="j8(this)" ID=f74></TD><TD CLASS=c0 ID=c84><INPUT CLASS=d0 SIZE=2 AUTOCOMPLETE=off NAME=h54r595 MAXLENGTH=5 onKeyUp="j5(this)" onBlur="j8(this)" ID=f84></TD></TR><TR><TD CLASS=e0 ID=c05><INPUT CLASS=s0 SIZE=2 AUTOCOMPLETE=off NAME=sh54r516 READONLY VALUE="5" ID=f05></TD><TD CLASS=c0 ID=c15><INPUT CLASS=d0 SIZE=2 AUTOCOMPLETE=off NAME=h54r526 MAXLENGTH=5 onKeyUp="j5(this)" onBlur="j8(this)" ID=f15></TD><TD CLASS=c0 ID=c25><INPUT CLASS=d0 SIZE=2 AUTOCOMPLETE=off NAME=h54r536 MAXLENGTH=5 onKeyUp="j5(this)" onBlur="j8(this)" ID=f25></TD><TD CLASS=e0 ID=c35><INPUT CLASS=s0 SIZE=2 AUTOCOMPLETE=off NAME=sh54r546 READONLY VALUE="9" ID=f35></TD><TD CLASS=c0 ID=c45><INPUT CLASS=d0 SIZE=2 AUTOCOMPLETE=off NAME=h54r556 MAXLENGTH=5 onKeyUp="j5(this)" onBlur="j8(this)" ID=f45></TD><TD CLASS=c0 ID=c55><INPUT CLASS=d0 SIZE=2 AUTOCOMPLETE=off NAME=h54r566 MAXLENGTH=5 onKeyUp="j5(this)" onBlur="j8(this)" ID=f55></TD><TD CLASS=e0 ID=c65><INPUT CLASS=d0 SIZE=2 AUTOCOMPLETE=off NAME=h54r576 MAXLENGTH=5 onKeyUp="j5(this)" onBlur="j8(this)" ID=f65></TD><TD CLASS=c0 ID=c75><INPUT CLASS=s0 SIZE=2 AUTOCOMPLETE=off NAME=sh54r586 READONLY VALUE="2" ID=f75></TD><TD CLASS=c0 ID=c85><INPUT CLASS=d0 SIZE=2 AUTOCOMPLETE=off NAME=h54r596 MAXLENGTH=5 onKeyUp="j5(this)" onBlur="j8(this)" ID=f85></TD></TR><TR><TD CLASS=g0 ID=c06><INPUT CLASS=d0 SIZE=2 AUTOCOMPLETE=off NAME=h54r517 MAXLENGTH=5 onKeyUp="j5(this)" onBlur="j8(this)" ID=f06></TD><TD CLASS=f0 ID=c16><INPUT CLASS=d0 SIZE=2 AUTOCOMPLETE=off NAME=h54r527 MAXLENGTH=5 onKeyUp="j5(this)" onBlur="j8(this)" ID=f16></TD><TD CLASS=f0 ID=c26><INPUT CLASS=s0 SIZE=2 AUTOCOMPLETE=off NAME=sh54r537 READONLY VALUE="2" ID=f26></TD><TD CLASS=g0 ID=c36><INPUT CLASS=s0 SIZE=2 AUTOCOMPLETE=off NAME=sh54r547 READONLY VALUE="8" ID=f36></TD><TD CLASS=f0 ID=c46><INPUT CLASS=d0 SIZE=2 AUTOCOMPLETE=off NAME=h54r557 MAXLENGTH=5 onKeyUp="j5(this)" onBlur="j8(this)" ID=f46></TD><TD CLASS=f0 ID=c56><INPUT CLASS=d0 SIZE=2 AUTOCOMPLETE=off NAME=h54r567 MAXLENGTH=5 onKeyUp="j5(this)" onBlur="j8(this)" ID=f56></TD><TD CLASS=g0 ID=c66><INPUT CLASS=d0 SIZE=2 AUTOCOMPLETE=off NAME=h54r577 MAXLENGTH=5 onKeyUp="j5(this)" onBlur="j8(this)" ID=f66></TD><TD CLASS=f0 ID=c76><INPUT CLASS=s0 SIZE=2 AUTOCOMPLETE=off NAME=sh54r587 READONLY VALUE="3" ID=f76></TD><TD CLASS=f0 ID=c86><INPUT CLASS=d0 SIZE=2 AUTOCOMPLETE=off NAME=h54r597 MAXLENGTH=5 onKeyUp="j5(this)" onBlur="j8(this)" ID=f86></TD></TR><TR><TD CLASS=e0 ID=c07><INPUT CLASS=d0 SIZE=2 AUTOCOMPLETE=off NAME=h54r518 MAXLENGTH=5 onKeyUp="j5(this)" onBlur="j8(this)" ID=f07></TD><TD CLASS=c0 ID=c17><INPUT CLASS=d0 SIZE=2 AUTOCOMPLETE=off NAME=h54r528 MAXLENGTH=5 onKeyUp="j5(this)" onBlur="j8(this)" ID=f17></TD><TD CLASS=c0 ID=c27><INPUT CLASS=s0 SIZE=2 AUTOCOMPLETE=off NAME=sh54r538 READONLY VALUE="9" ID=f27></TD><TD CLASS=e0 ID=c37><INPUT CLASS=s0 SIZE=2 AUTOCOMPLETE=off NAME=sh54r548 READONLY VALUE="7" ID=f37></TD><TD CLASS=c0 ID=c47><INPUT CLASS=d0 SIZE=2 AUTOCOMPLETE=off NAME=h54r558 MAXLENGTH=5 onKeyUp="j5(this)" onBlur="j8(this)" ID=f47></TD><TD CLASS=c0 ID=c57><INPUT CLASS=d0 SIZE=2 AUTOCOMPLETE=off NAME=h54r568 MAXLENGTH=5 onKeyUp="j5(this)" onBlur="j8(this)" ID=f57></TD><TD CLASS=e0 ID=c67><INPUT CLASS=d0 SIZE=2 AUTOCOMPLETE=off NAME=h54r578 MAXLENGTH=5 onKeyUp="j5(this)" onBlur="j8(this)" ID=f67></TD><TD CLASS=c0 ID=c77><INPUT CLASS=d0 SIZE=2 AUTOCOMPLETE=off NAME=h54r588 MAXLENGTH=5 onKeyUp="j5(this)" onBlur="j8(this)" ID=f77></TD><TD CLASS=c0 ID=c87><INPUT CLASS=s0 SIZE=2 AUTOCOMPLETE=off NAME=sh54r598 READONLY VALUE="1" ID=f87></TD></TR><TR><TD CLASS=i0 ID=c08><INPUT CLASS=d0 SIZE=2 AUTOCOMPLETE=off NAME=h54r519 MAXLENGTH=5 onKeyUp="j5(this)" onBlur="j8(this)" ID=f08></TD><TD CLASS=h0 ID=c18><INPUT CLASS=d0 SIZE=2 AUTOCOMPLETE=off NAME=h54r529 MAXLENGTH=5 onKeyUp="j5(this)" onBlur="j8(this)" ID=f18></TD><TD CLASS=h0 ID=c28><INPUT CLASS=s0 SIZE=2 AUTOCOMPLETE=off NAME=sh54r539 READONLY VALUE="6" ID=f28></TD><TD CLASS=i0 ID=c38><INPUT CLASS=d0 SIZE=2 AUTOCOMPLETE=off NAME=h54r549 MAXLENGTH=5 onKeyUp="j5(this)" onBlur="j8(this)" ID=f38></TD><TD CLASS=h0 ID=c48><INPUT CLASS=s0 SIZE=2 AUTOCOMPLETE=off NAME=sh54r559 READONLY VALUE="1" ID=f48></TD><TD CLASS=h0 ID=c58><INPUT CLASS=d0 SIZE=2 AUTOCOMPLETE=off NAME=h54r569 MAXLENGTH=5 onKeyUp="j5(this)" onBlur="j8(this)" ID=f58></TD><TD CLASS=i0 ID=c68><INPUT CLASS=s0 SIZE=2 AUTOCOMPLETE=off NAME=sh54r579 READONLY VALUE="4" ID=f68></TD><TD CLASS=h0 ID=c78><INPUT CLASS=d0 SIZE=2 AUTOCOMPLETE=off NAME=h54r589 MAXLENGTH=5 onKeyUp="j5(this)" onBlur="j8(this)" ID=f78></TD><TD CLASS=h0 ID=c88><INPUT CLASS=d0 SIZE=2 AUTOCOMPLETE=off NAME=h54r599 MAXLENGTH=5 onKeyUp="j5(this)" onBlur="j8(this)" ID=f88></TD></TR></TABLE>
'''

import copy
import time
from timeit import default_timer as timer
import urllib
import urllib.request
from lxml import html

from sudoku import Sudoku


def load_websudoku(url):
    page = html.fromstring(urllib.request.urlopen(url).read())

    #table = page.xpath("//table[@id='puzzle_grid']");
    r = 0
    quiz = ''
    solution = None
    for row in page.xpath("//table[@id='puzzle_grid']/tr"):
        c = 0
        for td in row.xpath("td"):
            val = td.xpath("input")[0].value
            if val == None:
                val = "0"
            quiz += val
            c += 1
        if c != 9:
            raise ValueError(f'Unexpected numer of cols {c}, should be 9')
        r += 1
    if r != 9:
        raise ValueError(f'Unexpected number of rows {r}, should be 9')
    return quiz, solution

def main():
    # url = "https://www.websudoku.com/?level=4&set_id=6809462743"
    # url = "https://www.websudoku.com/?level=4&set_id=6809462743"
    # url = "https://www.websudoku.com/?level=4&set_id=4197772595"
    # url = "https://www.websudoku.com/?level=4&set_id=6231633663"
    # url = "https://www.websudoku.com/?level=4&set_id=8519486668"
    # url = "https://www.websudoku.com/?level=4&set_id=4289253008"
    # url = "https://www.websudoku.com/?level=4&set_id=6923075776"
    # url = "https://www.websudoku.com/?level=4&set_id=7787682906"
    # url = "https://www.websudoku.com/?level=4&set_id=5568841569"
    # url = "https://www.websudoku.com/?level=4&set_id=617724693"
    # url = "https://www.websudoku.com/?level=4&set_id=5883022923"
    url = "https://www.websudoku.com/?level=4&set_id=6232523912"

    url = url.replace('//www.websudoku.com/', '//show.websudoku.com/')
    quiz, solution = load_websudoku(url)
    s = Sudoku(quiz, solution)

    print()
    print(f'URL      : {url}')
    print(f'Quiz     : {s.quiz}')
    print(f'Solution : {s.solution}')

    s.solver(s.quiz)
    s.solver(s.quiz, s.solve_eliminator)


if __name__ == "__main__":
    main()